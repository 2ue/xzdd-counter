# 四川血战到底计分

血战到底是多人麻将，在过程中玩家会不断胡牌（自摸或者被点炮），胡牌的玩家就就不参与当前牌局，需要等到其他玩家胡牌，直到只剩一个未胡牌的玩家，进行下一轮。
注意：如果A玩家胡牌后，后续所产生的所有胡牌，杠等所有产生分数的行为都不影响之前已经A玩家

所以基于这种行为开发一个可视化计分系统，下面是一些规则说明和希望的UI说明

## 番型系统

现在支持番型叠加，某些番型会互斥，比如小七对不可能杠上花，因为小七对不可能碰牌和杠牌，所以不可能杠上花，但是在页面不做限制，让玩家自由选择：

番型对得分的影响是2的次方，多少番就是2的多少次方

### 番型
- **小胡**: 0番
- **大对子**: 1番
- **金钩钓**: 2番
- **小七对**: 2番
- **龙七对**: 3番
- **清一色**: 2番
- **杠上花**: 2番
- **杠上炮**: 1番
- **海底捞**: 1番

## 部分组合使用计算示例

### 示例1：清一色海底捞自摸
1. **基础番型**: 选择"清一色"（2番）
2. **额外番型**: 勾选"海底捞"（额外1番）
3. **胡牌方式**: 选择"自摸"（+1分）
4. **计算结果**: 2番(清一色) + 1番(海底捞) + 1分(自摸) = 2的3次方 + 1 = 9分

### 示例2：清一色自摸
1. **基础番型**: 选择"清一色"（2番）
2. **额外番型**: 不选择任何额外番型
3. **胡牌方式**: 选择"自摸"（+1分）
4. **计算结果**: 2番(清一色) + 1分(自摸) = 2的2次方 + 1 = 5分

### 示例3：大对子杠上花
1. **基础番型**: 选择"大对子"（1番）
2. **额外番型**: 勾选"杠上花"（额外2番）
3. **胡牌方式**: 选择"自摸"（+1分）
4. **计算结果**: 1番(大对子) + 2番(杠上花) = 2的3次方 + 1 = 9分

### 示例4：龙七对海底捞自摸
1. **基础番型**: 选择"龙七对"（3番）
2. **额外番型**: 勾选"海底捞"（额外1番）
3. **胡牌方式**: 选择"自摸"（+1分）
4. **计算结果**: 3番(龙七对) + 1番(海底捞) + 1分(自摸) = 2的4次方 + 1 = 17分

## 规则
1. **番型**: 必须选择一个，可叠加，有n番，得分就是2的n次方
2. **点炮**: 点炮者输分，胡牌者得分
3. **自摸**：所有在场（没有胡牌的）玩家都会丢分，比如A小胡自摸了B,C,D，那么得分是小胡1番得1分+自摸1分=2分，A总得分为2 * 3 = 6分，其余没人负2分，如果C在，A自摸前已经胡牌，他就不在场，那么就是A自摸了B,D，A总得分为4分
4. **自摸加分**: 自摸额外加1分，点炮不加分
5. **暗杠**: 所有在场（没有胡牌的）玩家都-2分
6. **巴杠**: 所有在场（没有胡牌的）玩家都-1分
7. **点杠**: A点杠B，则A-2分，B+2分
8. **杠上花**: 等于小胡+杠+花+自摸
9. **封顶处理**: 如果设置了封顶番数，超过封顶的番数会被限制
10. **总分平衡**：所有玩家分数加和应该等于初始分数加和


## 其他说明
1. **数据持久化**: 所有事件都会自动保存到本地存储
2. **封顶设置**: 可以设定封顶番型，默认4番

## UI说明

希望使用现代化的技术pnpm+ts+react+vite+tailwindcss3+shadcn-ui(或者radix-ui)
希望能够实现响应式布局
使用现代化图标和布局样式
层次分明
关联性强的尽可能放到一起
需要记录总得分排行榜，显示总分平衡
允许增删玩家，删除玩家后所有依赖玩家显示的地方要正常显示，比如排行榜玩家A-5分，但是删除了玩家，也需要展示出来，但是可以进行标记
允许重置游戏，需要二次提示
考虑使用事件或者流水的形式来记录？

